<!DOCTYPE html>
<html lang="en">
    
    <%- include('../partials/head.ejs', {title: 'My Profile'}) %>
    
    <body>

        <%- include('../partials/header.ejs') %>
        
        <main class="container">
            
            <div class="d-flex flex-wrap justify-content-center">
                
                <div class="mt-5">
                    <h1 class=""><%= user.name %></h1>
                </div>
                
                <div class="d-flex justify-content-center my-4">
                    <img src="/images/user.png" width="30%" class="rounded-circle">
                </div>
    
                <div class="justify-content-center mb-1">
                    <h3 class="">Available points: <%= user.points %> <img src="/images\icons\coin.svg" alt="coin"></h3>
                </div>

                <div class="container d-flex justify-content-center my-3">
                    
                    <button type="button" class="btn btn-info modal-trigger" data-bs-toggle="modal" data-bs-target="#myModal">Add points</button>
                    
                    <div class="modal">
                        <div class="modal-dialog">
                            <div class="modal-content shadow">
                                
                                <div class="modal-header">
                                    <h4 class="modal-title ps-2 pe-2">How many points do you want to add?</h4>
                                </div>

                                <div class="modal-body d-flex justify-content-around pb-0 align-items-end">
                                    
                                    <span>
                                        <img src="/images\icons\coin.svg" alt="coin">
                                    </span>
                                    
                                    <span>
                                        <img src="/images\icons\coin.svg" alt="coin">
                                    </span>
                                    
                                    <span>
                                        <img src="/images\icons\coin.svg" alt="coin">
                                    </span>

                                </div>

                                <div class="modal-body d-flex justify-content-around pt-0 align-items-start">
                                    
                                    <form action="/user/points/1000" method="POST" enctype="multipart/form-data"> 
                                        <button type="submit" class="btn btn-warning fw-bold ps-3 pe-3 pt-2 pb-2">1000</button>
                                    </form>

                                    <form action="/user/points/5000" method="POST" enctype="multipart/form-data"> 
                                        <button type="submit" class="btn btn-warning fw-bold ps-3 pe-3 pt-2 pb-2">5000</button>
                                    </form>

                                    <form action="/user/points/7500" method="POST" enctype="multipart/form-data"> 
                                        <button type="submit" class="btn btn-warning fw-bold ps-3 pe-3 pt-2 pb-2">7500</button>
                                    </form>

                                </div>
                                
                                <div class="modal-footer justify-content-center">
                                    <button type="button" class="btn btn-danger exit ps-4 pe-4" data-bs-dismiss="modal">Cancel</button>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
            
            <div class="container d-flex justify-content-center dropdown mt-3 mb-4">
                <button onclick="showHistory()" class="btn btn-info dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                  History
                </button>
            </div>

            <div class="history row align-items-center justify-content-evenly visually-hidden">
                
                <div class="justify-content-center mb-1">
                    <h3 class="text-center">Total points spent: <%= totalSpent %> <img src="/images\icons\coin.svg" alt="coin"></h3>
                </div>
                
                <% for (product of history) { %>
                    
                    <div class="card p-3 m-3 shadow custom-card history-card" style="width: 18rem;">
                        
                        <img src="<%= product.img.hdUrl %>" alt="image" class="mb-3">
                        
                        <div class="card-body text-center division pb-2">
                            <h5 class="card-text" style="color: black;"><%= product.name %></h5>
                            <h5 class="card-text text-black-50">Points spent: <%= product.cost %> <img src="/images\icons\coin.svg" alt="coin" width="10%"></h5>
                        </div>
                        
                    </div>

                <% } %>
                
            </div>
            
            <div class="d-flex justify-content-center mt-5">
                <button class="btn btn-danger">Delete Profile</button>
            </div>

        </main>
        
        <%- include('../partials/footer.ejs') %>

        <script src="../js/scripts.js" type="text/javascript"></script>
    
        <script src="https://unpkg.com/@popperjs/core@2/dist/umd/popper.js"></script>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
    
    </body>
    
</html>